# 質量檢查清單 (Quality Checklist)

## 1. 代碼質量 (Code Quality) - Linus Style

### 1.1 簡潔性 (Simplicity)
- [ ] **函數長度**: 每個函數是否只做一件事？(建議 < 50 行)
- [ ] **嵌套深度**: 是否避免了超過 3 層的嵌套？(使用 early return)
- [ ] **變量命名**: 變量名是否清晰且具描述性？(避免 `a`, `b`, `tmp`)
- [ ] **死代碼**: 是否移除了所有未使用的代碼和註釋掉的代碼？

### 1.2 可讀性 (Readability)
- [ ] **邏輯流**: 代碼閱讀順序是否自然？(從上到下)
- [ ] **註釋**: 註釋是否解釋了"為什麼"而不是"做什麼"？
- [ ] **常量**: 魔術數字是否已提取為常量？(如 `REQUEST_TIMEOUT = 30`)
- [ ] **格式**: 是否符合 PEP 8 規範？

### 1.3 健壯性 (Robustness)
- [ ] **輸入驗證**: 所有公共函數是否驗證了參數？
- [ ] **異常處理**: 是否捕獲了特定的異常而不是 `Exception`？
- [ ] **資源管理**: 是否使用了 `with` 語句管理文件和數據庫連接？
- [ ] **邊界情況**: 是否處理了空列表、None、0 等邊界情況？

## 2. 功能測試 (Functional Testing)

### 2.1 數據獲取
- [ ] **FinMind**: 能否成功下載數據？
- [ ] **Official**: FinMind 失敗時能否自動切換？
- [ ] **斷點續傳**: 中斷後重啟能否從上次進度繼續？
- [ ] **去重**: 下載的數據是否無重複日期？

### 2.2 指標計算
- [ ] **WMA**: 計算結果是否與預期一致？(手動驗證前5筆)
- [ ] **RSI**: 值是否在 0-100 之間？
- [ ] **MACD**: 快慢線交叉邏輯是否正確？
- [ ] **VP**: POC 是否位於成交量最大的價格區間？

### 2.3 篩選與分析
- [ ] **A規則**: 是否正確過濾了 ETF 和 DR 股？
- [ ] **三重篩選**: 篩選結果是否符合所有條件？
- [ ] **排序**: 排行榜排序是否正確？

## 3. 性能測試 (Performance Testing)

### 3.1 速度
- [ ] **啟動時間**: 應用啟動是否 < 2秒？
- [ ] **單股處理**: 下載+計算是否 < 1秒？
- [ ] **批量處理**: 1000 檔股票是否在 5 分鐘內完成？

### 3.2 資源
- [ ] **內存**: 長時間運行後內存是否穩定？(< 500MB)
- [ ] **CPU**: 是否有效利用了多核？(ThreadPoolExecutor)
- [ ] **磁盤**: 數據庫大小是否合理？(WAL 文件是否定期清理)

## 4. 安全性檢查 (Security Checklist)

### 4.1 數據安全
- [ ] **SQL注入**: 所有 SQL 查詢是否都使用了參數化？
- [ ] **API Token**: Token 是否從環境變量讀取？
- [ ] **敏感信息**: 日誌中是否過濾了敏感信息？

### 4.2 運行環境
- [ ] **權限**: 是否以非 root 用戶運行？(Android 除外)
- [ ] **路徑**: 文件路徑操作是否安全？(使用 pathlib)

## 5. 兼容性檢查 (Compatibility Checklist)

### 5.1 平台
- [ ] **Windows**: VT100 顏色顯示是否正常？
- [ ] **Android**: 數據庫是否使用 DELETE 模式？
- [ ] **Linux**: termios 是否正常工作？

### 5.2 Python 版本
- [ ] **3.7**: 是否測試通過？
- [ ] **3.10+**: 是否測試通過？

## 6. 發布前確認 (Pre-release Confirmation)

- [ ] 所有 P0 任務已完成
- [ ] 所有單元測試通過
- [ ] 文檔已更新
- [ ] 版本號已更新 (v41)
- [ ] 變更日誌 (Changelog) 已編寫
