# Change: Migrate Features from 最終修正.py to Kivy App

## Why
用戶希望將 `最終修正.py` 的完整分析功能移植到 Android App，讓手機上也能執行所有掃描和查詢功能。

## What Changes
將以下功能從 `最終修正.py` 移植到 Kivy App：

### 核心掃描功能 (7種)
1. **VP掃描** - 接近支撐/壓力區
2. **MFI掃描** - 資金流入/流出
3. **MA均線掃描** - 距離MA200/MA20
4. **三重篩選** - 成交量+趨勢+突破
5. **月KD交叉** - K穿越D訊號
6. **均線多頭** - 五線上揚
7. **聰明錢掃描** - Smart Score ≥ 3

### 查詢功能
- 單一股票詳細資訊查詢

## Impact
- **新增**: `twse_app/core/scanner.py` - 掃描邏輯模組
- **新增**: `twse_app/core/indicators.py` - 指標計算 (從 Supabase 讀取)
- **修改**: `twse_app/screens/scan.py` - 掃描介面重構
- **修改**: `twse_app/screens/home.py` - 股票查詢功能

## 技術架構

```
┌─────────────────────────────────────────┐
│           Android App (Kivy)            │
├─────────────────────────────────────────┤
│  screens/                               │
│    ├── home.py (股票查詢)               │
│    ├── scan.py (7種掃描)                │
│    ├── watchlist.py (自選股)            │
│    └── settings.py                      │
├─────────────────────────────────────────┤
│  core/                                  │
│    ├── supabase_client.py (API)         │
│    ├── scanner.py (掃描邏輯)            │
│    └── indicators.py (指標處理)         │
├─────────────────────────────────────────┤
│              Supabase (雲端)            │
│         stock_data (57萬筆)             │
└─────────────────────────────────────────┘
```

## 實作順序

### 階段 1: 掃描介面 (~30 分鐘)
- [ ] 重構 `scan.py` 新增 7 個掃描按鈕
- [ ] 實作掃描結果列表顯示

### 階段 2: 核心邏輯 (~1 小時)
- [ ] 創建 `scanner.py` 模組
- [ ] 從 Supabase 讀取數據並在 App 端計算

### 階段 3: 首頁查詢 (~20 分鐘)
- [ ] 股票搜尋功能
- [ ] 詳細資訊顯示

### 階段 4: 測試與編譯 (~30 分鐘)
- [ ] 本地測試
- [ ] 推送 GitHub 並觸發編譯

---

> **⚠️ 重要決策點**
> 
> App 端計算 vs 雲端計算：
> - **App 端計算**: 需要下載大量數據，較慢但省 Supabase 資源
> - **雲端計算 (推薦)**: 在 Supabase 使用 SQL 查詢完成，更快更省流量
> 
> 請確認您偏好哪種方式？
